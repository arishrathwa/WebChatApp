{"ast":null,"code":"import _classCallCheck from\"D:/VSCode/SessionAuth/ChatApp/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"D:/VSCode/SessionAuth/ChatApp/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _slicedToArray from\"D:/VSCode/SessionAuth/ChatApp/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{Fragment,useState,useEffect}from'react';import{NavLink}from'react-router-dom';import{useLocation}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function ChatUI(_ref){var title=_ref.title,onDelete=_ref.onDelete,params=_ref.params;// To access props from react routers useLocation hook is used\nvar location=useLocation();console.log(\"PARAMS : \",location.params);var _useState=useState(location.params),_useState2=_slicedToArray(_useState,2),friendGroup=_useState2[0],setfriendGroup=_useState2[1];//*************************************************************** */\n//*******WEB SOCKETS********************************************* */\nvar roomName=friendGroup.connectionid;/****/ //\nvar LoadOldMessagesStatus=/*#__PURE__*/function(){function LoadOldMessagesStatus(){_classCallCheck(this,LoadOldMessagesStatus);}_createClass(LoadOldMessagesStatus,null,[{key:\"loadValue\",value:function loadValue(){return this.loaded;}}]);return LoadOldMessagesStatus;}();LoadOldMessagesStatus.loaded=false;LoadOldMessagesStatus.loadmsgcount=1;var sender=\"\";/**/var chatSocket=\"\";useEffect(function(){chatSocket=new WebSocket('ws://'+window.location.host+'/ws/chat/'+roomName+'/');},[]);chatSocket.onopen=function(e){};chatSocket.onmessage=function(e){var data=JSON.parse(e.data);console.log(data);// if(data.messagestamp == 'new' || (data.messagestamp == 'old' && !LoadOldMessagesStatus.loadValue())) {\n// if(data.sender === sender)\n// document.querySelector('#chat-log').value += ('\\t\\t\\t'+data.message+'\\n')\n// else    \ndocument.querySelector('#chat-log').value+=data.message+'\\n';// if (data.messagestamp == 'old') {\n//     LoadOldMessagesStatus.loadmsgcount = data.messagecount\n//     if (LoadOldMessagesStatus.loadmsgcount == 1){\n//         LoadOldMessagesStatus.loaded = true;\n//     }\n// }    \n// }\n};chatSocket.onclose=function(e){console.error('Chat socket closed unexpectedly');};document.querySelector('#chat-message-input').focus();document.querySelector('#chat-message-input').onkeyup=function(e){if(e.keyCode===13){// enter, return\ndocument.querySelector('#chat-message-submit').click();}};document.querySelector('#chat-message-submit').onclick=function(e){var messageInputDom=document.querySelector('#chat-message-input');var message=messageInputDom.value;sender=document.querySelector(\"#chat-message-sender\").value;chatSocket.send(JSON.stringify({'message':message,'sender':sender}));messageInputDom.value='';document.querySelector(\"#chat-message-sender\").value=\"\";};//*/*//////////////////////////////////////////////////////////////\n//**************************************************************** */\nreturn/*#__PURE__*/_jsx(Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"container-fluid p-2\",children:[/*#__PURE__*/_jsx(\"nav\",{class:\"navbar navbar-dark bg-primary\",children:/*#__PURE__*/_jsxs(\"div\",{class:\"container-fluid\",children:[/*#__PURE__*/_jsx(NavLink,{className:\"btn btn-light\",exact:true,to:\"/friends\",children:\"Back\"}),/*#__PURE__*/_jsx(\"h3\",{children:friendGroup.friend})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-auto\",children:/*#__PURE__*/_jsx(\"textarea\",{name:\"chat-log\",id:\"chat-log\",cols:\"30\",rows:\"10\"})}),/*#__PURE__*/_jsx(\"nav\",{class:\"navbar fixed-bottom navbar-light bg-light\",children:/*#__PURE__*/_jsxs(\"div\",{class:\"container-fluid\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"chat-message-submit\",className:\"form-control w-50 mx-auto\"}),/*#__PURE__*/_jsx(\"a\",{class:\"btn btn-success mx-auto\",href:\"#\",children:\"Send\"})]})})]})});}","map":{"version":3,"sources":["D:/VSCode/SessionAuth/ChatApp/frontend/src/containers/Chat.js"],"names":["React","Fragment","useState","useEffect","NavLink","useLocation","ChatUI","title","onDelete","params","location","console","log","friendGroup","setfriendGroup","roomName","connectionid","LoadOldMessagesStatus","loaded","loadmsgcount","sender","chatSocket","WebSocket","window","host","onopen","e","onmessage","data","JSON","parse","document","querySelector","value","message","onclose","error","focus","onkeyup","keyCode","click","onclick","messageInputDom","send","stringify","friend"],"mappings":"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","sourcesContent":["import React, { Fragment,useState,useEffect } from 'react'\r\nimport { NavLink } from 'react-router-dom'\r\nimport { useLocation } from 'react-router-dom'\r\nexport default function ChatUI({ title, onDelete,params }) {\r\n    // To access props from react routers useLocation hook is used\r\n    const location = useLocation()\r\n    console.log(\"PARAMS : \",location.params)\r\n    const [friendGroup, setfriendGroup] = useState(location.params)\r\n    //*************************************************************** */\r\n\r\n    //*******WEB SOCKETS********************************************* */\r\n\r\n        \r\n    const roomName = friendGroup.connectionid;\r\n    /****///\r\n    \r\n    class LoadOldMessagesStatus {\r\n        static loaded = false\r\n        static loadmsgcount = 1\r\n        static loadValue() {\r\n            return this.loaded;\r\n        }\r\n    }    \r\n\r\n    let sender =\"\";\r\n    \r\n    /**/\r\n    let chatSocket = \"\";\r\n    \r\n    useEffect(() => {\r\n        chatSocket = new WebSocket(\r\n            'ws://'\r\n            + window.location.host\r\n            + '/ws/chat/'\r\n            + roomName\r\n            + '/'\r\n        );\r\n    }, []) \r\n    \r\n    chatSocket.onopen = function(e) {\r\n        \r\n    }\r\n\r\n    chatSocket.onmessage = function(e) {\r\n        const data = JSON.parse(e.data);\r\n        console.log(data)\r\n        // if(data.messagestamp == 'new' || (data.messagestamp == 'old' && !LoadOldMessagesStatus.loadValue())) {\r\n\r\n            // if(data.sender === sender)\r\n                // document.querySelector('#chat-log').value += ('\\t\\t\\t'+data.message+'\\n')\r\n            // else    \r\n                document.querySelector('#chat-log').value += (data.message + '\\n');\r\n\r\n            // if (data.messagestamp == 'old') {\r\n            //     LoadOldMessagesStatus.loadmsgcount = data.messagecount\r\n            //     if (LoadOldMessagesStatus.loadmsgcount == 1){\r\n            //         LoadOldMessagesStatus.loaded = true;\r\n            //     }\r\n            // }    \r\n\r\n        // }\r\n    };\r\n\r\n    chatSocket.onclose = function(e) {\r\n        console.error('Chat socket closed unexpectedly');\r\n    };\r\n\r\n    document.querySelector('#chat-message-input').focus();\r\n    document.querySelector('#chat-message-input').onkeyup = function(e) {\r\n        if (e.keyCode === 13) {  // enter, return\r\n            document.querySelector('#chat-message-submit').click();\r\n        }\r\n    };\r\n\r\n    document.querySelector('#chat-message-submit').onclick = function(e) {\r\n        const messageInputDom = document.querySelector('#chat-message-input');\r\n        const message = messageInputDom.value;\r\n        sender =   document.querySelector(\"#chat-message-sender\").value;\r\n        chatSocket.send(JSON.stringify({\r\n            'message': message,\r\n            'sender' : sender\r\n        }));\r\n        \r\n        messageInputDom.value = '';\r\n        document.querySelector(\"#chat-message-sender\").value = \"\";\r\n    };\r\n\r\n\r\n    //*/*//////////////////////////////////////////////////////////////\r\n\r\n\r\n    //**************************************************************** */\r\n    \r\n    return (\r\n        <Fragment>\r\n            <div className='container-fluid p-2'>\r\n                <nav class=\"navbar navbar-dark bg-primary\">\r\n                    <div class=\"container-fluid\">\r\n                        <NavLink className=\"btn btn-light\" exact to=\"/friends\">Back</NavLink>\r\n                        <h3>{friendGroup.friend}</h3>\r\n                    </div>\r\n                </nav>    \r\n                <div className='overflow-auto'>\r\n                    <textarea name=\"chat-log\" id=\"chat-log\" cols=\"30\" rows=\"10\"></textarea>\r\n                    {/* CHAT COMPONENT */}\r\n                </div>\r\n                <nav class=\"navbar fixed-bottom navbar-light bg-light\">\r\n                    <div class=\"container-fluid\">\r\n                    <input type=\"text\" id=\"chat-message-submit\" className='form-control w-50 mx-auto' />\r\n                    <a class=\"btn btn-success mx-auto\" href=\"#\">Send</a>\r\n                    </div>\r\n                </nav>\r\n            </div>\r\n        </Fragment>\r\n    )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}